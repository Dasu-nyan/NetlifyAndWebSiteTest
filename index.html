<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>親画面</title>
        <script>
            // 子画面関連部分
            let childWindow = null;

            function openChild() {
                childWindow = window.open("child.html", "childWindow");
                if (childWindow) {
                    document.getElementById("status").textContent = "✅ 子画面を開きました";
                    setTimeout(closeChild, 20000); // 20秒後に閉じる
                } else {
                    // childWindowがnullやundefinedの時、画面上に詳細情報を表示
                    document.getElementById("status").textContent = "❌ 子画面を開けませんでした";
                    document.getElementById("error-details").textContent = "childWindow: " + childWindow;
                }
            }

            function closeChild() {
                if (childWindow && !childWindow.closed) {
                    childWindow.close();
                    document.getElementById("status").textContent = "✅ 子画面を閉じました";
                } else {
                    document.getElementById("status").textContent = "❌ 既に閉じられているか、開くのに失敗しました";
                }
            }

            // ジェスチャー封じ部分
            let EDGE_THRESHOLD = 16;

            const edgeInputElement = document.getElementById('edgeRange');
            const edgeDisplayElement = document.getElementById('currentTheshold');

            edgeInputElement.addEventListener('input', () => {
                EDGE_THRESHOLD = parseInt(edgeInputElement.value, 10);
                displaySpan.textContent = EDGE_THRESHOLD;
            })
            document.addEventListener('touchstart', function (e) {
                const x = e.touches[0].pageX;
                if (x < EDGE_THRESHOLD || x > window.innerWidth - EDGE_THRESHOLD) {
                    e.preventDefault();
                }
            }, { passive: false })
        </script>
    </head>

    <body>
        <h1>親画面</h1>
        <button onclick="openChild()">子画面を開く</button>
        <button onclick="closeChild()">子画面を閉じる</button>
        <p id="status">子画面の状態: 未オープン</p>
        <p id="error-details" style="color: red;"></p> <!-- エラーメッセージ表示用 -->
        <br />
        <label for="edgeRange">ジェスチャーを封じる閾値(px):</label>
        <input type="range" id="edgeRange" min="1" max="100" value="16">
        <span id="currentTheshold">16</span>
    </body>

</html>
